<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roler2</title>
    <style>
        *{
            margin:0;
            padding:0;
        }
        html,body{
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
        }
        canvas{
            position:absolute;
        }
    </style>
</head>
<body>
<script type="module">
import Vec2 from "./public/core/vec2.js"
import Color from "./public/core/color.js";
import Mat3 from "./public/core/mat3.js"
import Render from "./public/node/CanvasRender.js"
import Node from "./public/node/Node.js"
import Sprite from "./public/node/Sprite.js"
import { GravityParticles, RadiusParticles } from "./public/node/Particles.js";
import Camera from "./public/node/Camera.js";

let render = new Render(window.innerWidth, window.innerHeight)
document.body.append(render.canvas)


let rect = []

// let temp = document.createElement("canvas").getContext("2d");
// temp.width = 10
// temp.height = 10
// let color = temp.createRadialGradient(5,5,0,5,5,5);
// color.addColorStop(0, "#ffffff");
// color.addColorStop(1, "#ffffff00");
// temp.fillStyle = color;
// // temp.fillStyle = "#fff"
// temp.beginPath()
// temp.arc(5, 5, 5, 0, 2*Math.PI);
// temp.closePath()
// // temp.fillRect(0, 0, 10, 10)
// temp.fill()
// console.log(temp)

let img = new Image()

img.src = "./public/src/player.png";

let image = null;
let camera = new Camera();
// camera.position.set(100, 40)

img.onload = function(){
    for(let i = 0;i < 1;i++){
        image = new Sprite(img);
        image.position.set(400, -400);
        // image.rotation = 90
        // image.scale.set(2, 2);
        image.color.set(255, 255, 255);
        render.add(image);
        rect.push(image);

        let sp = new Sprite(img);
        sp.position.set(400, 0)
        sp.rotation = 45
        image.add(sp);
        render.add(sp)
    }
    
}

// let p = new GravityParticles();
// p.position.set(300, -300)
// // p.setTargetType(2)
// p.setTotal(1000)
// p.setLife(1100)
// p.setLifeCycle(400)
// // p.setAngular(45)
// // p.setAngularCycle(50)
// p.setSpeed(60)
// p.setEmission(100)
// // p.setArea(new Vec2(20, 20))
// p.setGravity(new Vec2(0, 0));
// p.setStartSize(40);
// // p.setStartSpin(90)
// // p.setEndSize(40)
// p.setStartColor(new Color(26, 77, 200, 255))
// p.setEndColor(new Color(26, 77, 200, 0))
// render.add(p);
// // p.play();


function update(dt){
    render.update(dt);
    // console.log(p.getCount())

    // camera.position.x += 1;
    // camera.rotation++;
    // render.setViewTransform(camera.getViewTransform())
}
let time = 0
function gameloop(dt){
    requestAnimationFrame(gameloop);
    let t = (dt - time) / 1000;
    time = dt;
    // console.log(1/t|0)
    update(t * 1000)
    render.render(t*1000)
}
requestAnimationFrame(gameloop);



</script>
</body>
</html>